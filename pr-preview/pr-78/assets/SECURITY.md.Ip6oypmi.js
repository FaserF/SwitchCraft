import{_ as i,o as s,c as t,ag as a}from"./chunks/framework.6tpVHZl0.js";const u=JSON.parse('{"title":"Security","description":"","frontmatter":{},"headers":[],"relativePath":"SECURITY.md","filePath":"SECURITY.md","lastUpdated":1772325601000}'),n={name:"SECURITY.md"};function r(o,e,l,c,d,h){return s(),t("div",null,[...e[0]||(e[0]=[a(`<h1 id="security" tabindex="-1">Security <a class="header-anchor" href="#security" aria-label="Permalink to &quot;Security&quot;">‚Äã</a></h1><p>SwitchCraft is designed with enterprise security in mind. This page outlines the security features, potential conflicts, and best practices for using the tool safely.</p><h2 id="üîê-credential-protection" tabindex="-1">üîê Credential Protection <a class="header-anchor" href="#üîê-credential-protection" aria-label="Permalink to &quot;üîê Credential Protection&quot;">‚Äã</a></h2><p>Sensitive information, specifically <strong>Microsoft Graph API Client Secrets and Client IDs</strong>, are <strong>never stored in plain text</strong>.</p><ul><li><strong>System Keyring</strong>: SwitchCraft uses the <strong>Windows Credential Manager</strong> (via the <code>keyring</code> library) to encrypt and securely store these credentials locally on your machine.</li><li><strong>No Registry Leaks</strong>: Unlike standard configuration values, secrets are NOT stored in the Windows Registry, ensuring they cannot be easily read by unauthorized processes or users.</li></ul><h2 id="üõ°Ô∏è-automatic-vulnerability-scanning" tabindex="-1">üõ°Ô∏è Automatic Vulnerability Scanning <a class="header-anchor" href="#üõ°Ô∏è-automatic-vulnerability-scanning" aria-label="Permalink to &quot;üõ°Ô∏è Automatic Vulnerability Scanning&quot;">‚Äã</a></h2><p>To ensure the integrity of the tool, SwitchCraft performs an <strong>automatic security check</strong> of its internal Python environment upon every startup.</p><ul><li><strong>Check Scope</strong>: Scans all installed dependencies against the <a href="https://osv.dev" target="_blank" rel="noreferrer">OSV.dev</a> database.</li><li><strong>Alerts</strong>: Notifies the user if any local library has a known security vulnerability (CVE).</li><li><strong>Transparency</strong>: Provides direct links to vulnerability details and safe usage advice.</li></ul><h2 id="‚ö†Ô∏è-microsoft-defender-conditional-access" tabindex="-1">‚ö†Ô∏è Microsoft Defender &amp; Conditional Access <a class="header-anchor" href="#‚ö†Ô∏è-microsoft-defender-conditional-access" aria-label="Permalink to &quot;‚ö†Ô∏è Microsoft Defender &amp; Conditional Access&quot;">‚Äã</a></h2><h3 id="attack-surface-reduction-asr" tabindex="-1">Attack Surface Reduction (ASR) <a class="header-anchor" href="#attack-surface-reduction-asr" aria-label="Permalink to &quot;Attack Surface Reduction (ASR)&quot;">‚Äã</a></h3><p>Organizations implementing strict <strong>Attack Surface Reduction (ASR)</strong> rules may observe blocks when SwitchCraft attempts to:</p><ul><li><strong>Analyze installers</strong>: Requires reading file headers (PE/MSI analysis).</li><li><strong>Run External Tools</strong>: <code>IntuneWinAppUtil.exe</code> is executed as a child process.</li></ul><p><strong>Common ASR Rules that may trigger:</strong></p><ul><li><em>Block executable files from running unless they meet a prevalence, age, or trusted list criterion</em></li><li><em>Block process creations originating from PSExec and WMI commands</em> (if utilizing remote features)</li></ul><p><strong>Recommendation:</strong> If you experience issues, consider adding path exclusions for <code>SwitchCraft.exe</code> and the <code>tools/IntuneWinAppUtil.exe</code> directory in your Endpoint Security settings.</p><h3 id="conditional-access" tabindex="-1">Conditional Access <a class="header-anchor" href="#conditional-access" aria-label="Permalink to &quot;Conditional Access&quot;">‚Äã</a></h3><p>If your organization uses <strong>Conditional Access</strong> policies that restrict access to Microsoft Graph API (Intune) based on device compliance or specific locations, SwitchCraft might fail to upload apps.</p><ul><li><strong>Device Compliance</strong>: Ensure the machine running SwitchCraft is compliant.</li><li><strong>MFA</strong>: Since SwitchCraft uses <strong>Client Credentials Flow</strong> (App Identity), it generally bypasses user-interactive MFA. However, ensure the <strong>Service Principal</strong> (Enterprise Application) has not been blocked by specific Conditional Access policies targeting Service Principals.</li></ul><h2 id="üïµÔ∏è-safe-usage-tips" tabindex="-1">üïµÔ∏è Safe Usage Tips <a class="header-anchor" href="#üïµÔ∏è-safe-usage-tips" aria-label="Permalink to &quot;üïµÔ∏è Safe Usage Tips&quot;">‚Äã</a></h2><p>To maximize security when analyzing unknown installers:</p><ol><li><strong>Use Windows Sandbox</strong>: Run SwitchCraft inside <a href="https://learn.microsoft.com/en-us/windows/security/application-security/application-isolation/windows-sandbox/windows-sandbox-overview" target="_blank" rel="noreferrer">Windows Sandbox</a> to isolate the analysis environment. SwitchCraft allows portable usage which is perfect for this.</li><li><strong>Verify Digital Signatures</strong>: SwitchCraft displays publisher information. Always verify if the installer is signed by a trusted vendor.</li><li><strong>Use Limited Permissions</strong>: When configuring the Graph API, minimal permissions are required (<code>DeviceManagementApps.ReadWrite.All</code>). Do not grant <code>Directory.ReadWrite.All</code> unless necessary.</li></ol><h2 id="üõ†Ô∏è-third-party-tools-conflicts" tabindex="-1">üõ†Ô∏è Third-Party Tools &amp; Conflicts <a class="header-anchor" href="#üõ†Ô∏è-third-party-tools-conflicts" aria-label="Permalink to &quot;üõ†Ô∏è Third-Party Tools &amp; Conflicts&quot;">‚Äã</a></h2><ul><li><strong>Winget-AutoUpdate</strong>: If an app is detected on Winget, we recommend using <a href="https://github.com/Romanitho/Winget-AutoUpdate" target="_blank" rel="noreferrer">Winget-AutoUpdate</a> for easier maintenance.</li><li><strong>EDR Solutions</strong>: Some EDRs (CrowdStrike, SentinelOne) might flag the <em>behavior</em> of brute-force analysis (rapidly starting/stopping processes) as suspicious. Whitelisting the signing certificate of SwitchCraft is recommended.</li></ul><h2 id="‚ö†Ô∏è-development-server-security" tabindex="-1">‚ö†Ô∏è Development Server Security <a class="header-anchor" href="#‚ö†Ô∏è-development-server-security" aria-label="Permalink to &quot;‚ö†Ô∏è Development Server Security&quot;">‚Äã</a></h2><h3 id="esbuild-development-server-cors-vulnerability" tabindex="-1">esbuild Development Server (CORS Vulnerability) <a class="header-anchor" href="#esbuild-development-server-cors-vulnerability" aria-label="Permalink to &quot;esbuild Development Server (CORS Vulnerability)&quot;">‚Äã</a></h3><p><strong>Important</strong>: If you are using esbuild&#39;s <code>serve</code> feature directly (not through VitePress), be aware of a known security vulnerability.</p><p><strong>The Issue:</strong></p><ul><li>esbuild&#39;s development server sets <code>Access-Control-Allow-Origin: *</code> by default</li><li>This allows any website to send requests to your local development server and read responses</li><li>Malicious websites can steal your source code if you have the dev server running</li></ul><p><strong>Affected Scenarios:</strong></p><ul><li>Using <code>esbuild.serve()</code> directly in build scripts</li><li>Running esbuild dev server on <code>localhost</code> or <code>127.0.0.1</code></li><li>Having source maps enabled (exposes uncompiled source)</li></ul><p><strong>Mitigation:</strong></p><ol><li><strong>Never run esbuild serve in production</strong> - Only use for local development</li><li><strong>Use VitePress for documentation</strong> - VitePress handles esbuild securely</li><li><strong>Restrict CORS</strong> - If you must use esbuild serve, configure it to only allow specific origins:<div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">esbuild.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">serve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  servedir: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;dist&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Restrict CORS to localhost only</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  onRequest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: ({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">remoteAddress</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Only allow requests from localhost</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (remoteAddress </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;127.0.0.1&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> remoteAddress </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;::1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { status: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">403</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div></li><li><strong>Use a reverse proxy</strong> - Configure nginx or similar to add proper CORS headers</li><li><strong>Firewall protection</strong> - Ensure your firewall blocks external access to the dev server port</li></ol><p><strong>Current Project Status:</strong></p><ul><li>‚úÖ SwitchCraft uses <strong>VitePress 1.6.4</strong> for documentation</li><li>‚úÖ <strong>esbuild 0.27.2</strong> is used (CORS vulnerability fixed in 0.25.0+)</li><li>‚úÖ No direct esbuild serve usage in the codebase</li><li>‚úÖ npm overrides ensure all esbuild instances use the secure version</li><li>‚ö†Ô∏è If you add custom build scripts using esbuild serve, follow the mitigation steps above</li></ul><p><strong>References:</strong></p><ul><li><a href="https://github.com/evanw/esbuild/issues/xxx" target="_blank" rel="noreferrer">esbuild CORS Issue</a></li><li><a href="https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html#cross-origin-resource-sharing" target="_blank" rel="noreferrer">OWASP CORS Guide</a></li></ul>`,36)])])}const g=i(n,[["render",r]]);export{u as __pageData,g as default};
