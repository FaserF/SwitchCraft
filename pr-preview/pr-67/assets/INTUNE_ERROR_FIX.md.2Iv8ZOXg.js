import{_ as t,o as s,c as a,ag as e}from"./chunks/framework.tIOv17xw.js";const k=JSON.parse('{"title":"Intune Policy Error -2016281112: Detailed Troubleshooting","description":"","frontmatter":{},"headers":[],"relativePath":"INTUNE_ERROR_FIX.md","filePath":"INTUNE_ERROR_FIX.md","lastUpdated":1769294824000}'),n={name:"INTUNE_ERROR_FIX.md"};function l(o,i,r,h,p,d){return s(),a("div",null,[...i[0]||(i[0]=[e(`<h1 id="intune-policy-error-2016281112-detailed-troubleshooting" tabindex="-1">Intune Policy Error -2016281112: Detailed Troubleshooting <a class="header-anchor" href="#intune-policy-error-2016281112-detailed-troubleshooting" aria-label="Permalink to &quot;Intune Policy Error -2016281112: Detailed Troubleshooting&quot;">​</a></h1><h2 id="problem" tabindex="-1">Problem <a class="header-anchor" href="#problem" aria-label="Permalink to &quot;Problem&quot;">​</a></h2><p>All SwitchCraft policies show error code <strong>-2016281112</strong> (Remediation Failed), while the ADMX installation is successful.</p><h2 id="quick-diagnosis" tabindex="-1">Quick Diagnosis <a class="header-anchor" href="#quick-diagnosis" aria-label="Permalink to &quot;Quick Diagnosis&quot;">​</a></h2><p>If you see this error list:</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>SignScripts_Enf          → Error -2016281112</span></span>
<span class="line"><span>UpdateChannel_Enf        → Error -2016281112</span></span>
<span class="line"><span>EnableWinget_Enf         → Error -2016281112</span></span>
<span class="line"><span>AIProvider_Enf           → Error -2016281112</span></span>
<span class="line"><span>GraphTenantId_Enf        → Error -2016281112</span></span>
<span class="line"><span>CompanyName_Enf          → Error -2016281112</span></span>
<span class="line"><span>GraphClientId_Enf        → Error -2016281112</span></span>
<span class="line"><span>IntuneTestGroups_Enf     → Error -2016281112</span></span>
<span class="line"><span>GraphClientSecret_Enf    → Error -2016281112</span></span></code></pre></div><p>But:</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>SwitchCraftPolicy (ADMX Install) → Succeeded ✅</span></span></code></pre></div><p>Then the problem is <strong>NOT</strong> the ADMX installation, but the <strong>individual policy configurations</strong>.</p><h2 id="most-common-causes-in-order-of-probability" tabindex="-1">Most Common Causes (in order of probability) <a class="header-anchor" href="#most-common-causes-in-order-of-probability" aria-label="Permalink to &quot;Most Common Causes (in order of probability)&quot;">​</a></h2><h3 id="_1-❌-incorrect-data-type-90-of-cases" tabindex="-1">1. ❌ Incorrect Data Type (90% of cases) <a class="header-anchor" href="#_1-❌-incorrect-data-type-90-of-cases" aria-label="Permalink to &quot;1. ❌ Incorrect Data Type (90% of cases)&quot;">​</a></h3><p><strong>Problem</strong>: In Intune, the Data Type was set to &quot;Integer&quot;, &quot;Boolean&quot;, or &quot;String (Integer)&quot; instead of &quot;String&quot;.</p><p><strong>Solution</strong>:</p><ol><li>Open each failed policy in Intune</li><li>Check the <strong>Data Type</strong> - it MUST be <strong>&quot;String&quot;</strong> (sometimes also labeled &quot;String (XML)&quot;)</li><li>If incorrect: <strong>Delete the policy completely</strong> and recreate it with Data Type <strong>&quot;String&quot;</strong></li></ol><p><strong>IMPORTANT</strong>: Even if a policy is logically a Boolean or Integer (e.g., <code>SignScripts_Enf</code> = Enable/Disable), the Data Type must still be <strong>&quot;String&quot;</strong> because the value is an XML snippet!</p><h3 id="_2-❌-incorrect-xml-format" tabindex="-1">2. ❌ Incorrect XML Format <a class="header-anchor" href="#_2-❌-incorrect-xml-format" aria-label="Permalink to &quot;2. ❌ Incorrect XML Format&quot;">​</a></h3><p><strong>Problem</strong>: The XML in the Value field is incorrectly formatted or uses wrong element IDs.</p><p><strong>Correct XML Formats</strong>:</p><h4 id="for-boolean-policies-enable-disable" tabindex="-1">For Boolean Policies (Enable/Disable): <a class="header-anchor" href="#for-boolean-policies-enable-disable" aria-label="Permalink to &quot;For Boolean Policies (Enable/Disable):&quot;">​</a></h4><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p>or</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">disabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p><strong>Examples</strong>:</p><ul><li><code>SignScripts_Enf</code> → <code>&lt;enabled/&gt;</code></li><li><code>EnableWinget_Enf</code> → <code>&lt;enabled/&gt;</code></li></ul><h4 id="for-policies-with-values" tabindex="-1">For Policies with Values: <a class="header-anchor" href="#for-policies-with-values" aria-label="Permalink to &quot;For Policies with Values:&quot;">​</a></h4><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;[ELEMENT_ID]&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;[VALUE]&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p><strong>IMPORTANT</strong>: The <code>id</code> must <strong>exactly</strong> match the ADMX file!</p><p><strong>Correct Element IDs</strong> (from SwitchCraft.admx):</p><table tabindex="0"><thead><tr><th>Policy</th><th>Element ID (MUST be exactly this!)</th></tr></thead><tbody><tr><td><code>UpdateChannel_Enf</code></td><td><code>UpdateChannelDropdown</code></td></tr><tr><td><code>CompanyName_Enf</code></td><td><code>CompanyNameBox</code></td></tr><tr><td><code>GraphTenantId_Enf</code></td><td><code>GraphTenantIdBox</code></td></tr><tr><td><code>GraphClientId_Enf</code></td><td><code>GraphClientIdBox</code></td></tr><tr><td><code>GraphClientSecret_Enf</code></td><td><code>GraphClientSecretBox</code></td></tr><tr><td><code>IntuneTestGroups_Enf</code></td><td><code>IntuneTestGroupsBox</code></td></tr><tr><td><code>AIProvider_Enf</code></td><td><code>AIProviderDropdown</code></td></tr></tbody></table><p><strong>Incorrect Examples</strong> (will NOT work):</p><ul><li>❌ <code>&lt;data id=&quot;UpdateChannel&quot; value=&quot;stable&quot;/&gt;</code> → Wrong! Must be <code>UpdateChannelDropdown</code></li><li>❌ <code>&lt;data id=&quot;CompanyName&quot; value=&quot;Acme&quot;/&gt;</code> → Wrong! Must be <code>CompanyNameBox</code></li><li>❌ <code>&lt;data id=&quot;GraphTenantId&quot; value=&quot;...&quot;/&gt;</code> → Wrong! Must be <code>GraphTenantIdBox</code></li></ul><p><strong>Correct Examples</strong>:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- UpdateChannel_Enf --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;UpdateChannelDropdown&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;stable&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- CompanyName_Enf --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CompanyNameBox&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Acme Corp&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- GraphTenantId_Enf --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GraphTenantIdBox&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- GraphClientId_Enf --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GraphClientIdBox&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- GraphClientSecret_Enf --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GraphClientSecretBox&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;your-secret-here&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- IntuneTestGroups_Enf --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;IntuneTestGroupsBox&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GroupID1,GroupID2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">&lt;!-- AIProvider_Enf --&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;AIProviderDropdown&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;openai&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><h3 id="_3-❌-incorrect-oma-uri-path" tabindex="-1">3. ❌ Incorrect OMA-URI Path <a class="header-anchor" href="#_3-❌-incorrect-oma-uri-path" aria-label="Permalink to &quot;3. ❌ Incorrect OMA-URI Path&quot;">​</a></h3><p><strong>Problem</strong>: The OMA-URI path contains typos or uses incorrect separators.</p><p><strong>Correct OMA-URI Paths</strong> (complete):</p><table tabindex="0"><thead><tr><th>Policy</th><th>Complete OMA-URI</th></tr></thead><tbody><tr><td><code>SignScripts_Enf</code></td><td><code>./User/Vendor/MSFT/Policy/Config/SwitchCraft~Policy~FaserF~SwitchCraft~SwitchCraft~Enforced~Security_Enf/SignScripts_Enf</code></td></tr><tr><td><code>UpdateChannel_Enf</code></td><td><code>./User/Vendor/MSFT/Policy/Config/SwitchCraft~Policy~FaserF~SwitchCraft~SwitchCraft~Enforced~Updates_Enf/UpdateChannel_Enf</code></td></tr><tr><td><code>EnableWinget_Enf</code></td><td><code>./User/Vendor/MSFT/Policy/Config/SwitchCraft~Policy~FaserF~SwitchCraft~SwitchCraft~Enforced~General_Enf/EnableWinget_Enf</code></td></tr><tr><td><code>AIProvider_Enf</code></td><td><code>./User/Vendor/MSFT/Policy/Config/SwitchCraft~Policy~FaserF~SwitchCraft~SwitchCraft~Enforced~AI_Enf/AIProvider_Enf</code></td></tr><tr><td><code>GraphTenantId_Enf</code></td><td><code>./User/Vendor/MSFT/Policy/Config/SwitchCraft~Policy~FaserF~SwitchCraft~SwitchCraft~Enforced~Intune_Enf/GraphTenantId_Enf</code></td></tr><tr><td><code>CompanyName_Enf</code></td><td><code>./User/Vendor/MSFT/Policy/Config/SwitchCraft~Policy~FaserF~SwitchCraft~SwitchCraft~Enforced~General_Enf/CompanyName_Enf</code></td></tr><tr><td><code>GraphClientId_Enf</code></td><td><code>./User/Vendor/MSFT/Policy/Config/SwitchCraft~Policy~FaserF~SwitchCraft~SwitchCraft~Enforced~Intune_Enf/GraphClientId_Enf</code></td></tr><tr><td><code>IntuneTestGroups_Enf</code></td><td><code>./User/Vendor/MSFT/Policy/Config/SwitchCraft~Policy~FaserF~SwitchCraft~SwitchCraft~Enforced~Intune_Enf/IntuneTestGroups_Enf</code></td></tr><tr><td><code>GraphClientSecret_Enf</code></td><td><code>./User/Vendor/MSFT/Policy/Config/SwitchCraft~Policy~FaserF~SwitchCraft~SwitchCraft~Enforced~Intune_Enf/GraphClientSecret_Enf</code></td></tr></tbody></table><p><strong>IMPORTANT Rules</strong>:</p><ul><li>Use <code>~</code> (tilde) to separate namespace parts, NOT <code>/</code> (slash)</li><li>Category names end with <code>_Enf</code> (e.g., <code>General_Enf</code>, <code>Intune_Enf</code>, <code>Security_Enf</code>)</li><li>Policy names end with <code>_Enf</code> (e.g., <code>SignScripts_Enf</code>, <code>CompanyName_Enf</code>)</li></ul><h3 id="_4-❌-registry-path-does-not-exist" tabindex="-1">4. ❌ Registry Path Does Not Exist <a class="header-anchor" href="#_4-❌-registry-path-does-not-exist" aria-label="Permalink to &quot;4. ❌ Registry Path Does Not Exist&quot;">​</a></h3><p><strong>Problem</strong>: The registry path <code>HKCU\\Software\\Policies\\FaserF\\SwitchCraft</code> does not exist on the device.</p><p><strong>Solution</strong>: Create the registry path manually or via script:</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create registry path</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">New-Item</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Path </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;HKCU:\\Software\\Policies\\FaserF\\SwitchCraft&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Force </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Out-Null</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Check if it exists</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Get-ItemProperty</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Path </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;HKCU:\\Software\\Policies\\FaserF\\SwitchCraft&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ErrorAction SilentlyContinue</span></span></code></pre></div><p><strong>Note</strong>: Normally, this path should be created automatically when the ADMX installation was successful. If not, it may be a permissions issue.</p><h2 id="step-by-step-repair" tabindex="-1">Step-by-Step Repair <a class="header-anchor" href="#step-by-step-repair" aria-label="Permalink to &quot;Step-by-Step Repair&quot;">​</a></h2><h3 id="step-1-check-the-data-type" tabindex="-1">Step 1: Check the Data Type <a class="header-anchor" href="#step-1-check-the-data-type" aria-label="Permalink to &quot;Step 1: Check the Data Type&quot;">​</a></h3><p>For <strong>each</strong> failed policy:</p><ol><li>Open the policy in Intune Portal</li><li>Check the <strong>Data Type</strong></li><li>If it is <strong>NOT</strong> &quot;String&quot;: <ul><li><strong>Delete the policy completely</strong></li><li>Recreate it with Data Type <strong>&quot;String&quot;</strong></li></ul></li></ol><h3 id="step-2-check-the-xml-format" tabindex="-1">Step 2: Check the XML Format <a class="header-anchor" href="#step-2-check-the-xml-format" aria-label="Permalink to &quot;Step 2: Check the XML Format&quot;">​</a></h3><p>For each policy with a value (not just Enable/Disable):</p><ol><li>Open the policy</li><li>Check the <strong>Value</strong> field</li><li>Ensure that: <ul><li>The XML is correctly formatted</li><li>The <code>id</code> exactly matches the table above</li><li>There are no typos</li></ul></li></ol><p><strong>Example for <code>GraphTenantId_Enf</code></strong>:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GraphTenantIdBox&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p><strong>NOT</strong>:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GraphTenantId&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre></div><p>(Missing <code>Box</code> at the end!)</p><h3 id="step-3-check-the-oma-uri-path" tabindex="-1">Step 3: Check the OMA-URI Path <a class="header-anchor" href="#step-3-check-the-oma-uri-path" aria-label="Permalink to &quot;Step 3: Check the OMA-URI Path&quot;">​</a></h3><p>Compare each OMA-URI path character by character with the table above.</p><p><strong>Common Errors</strong>:</p><ul><li>❌ Using <code>/</code> instead of <code>~</code></li><li>❌ Forgetting <code>_Enf</code> at the end</li><li>❌ Wrong category name (e.g., <code>General</code> instead of <code>General_Enf</code>)</li></ul><h3 id="step-4-test-on-a-device" tabindex="-1">Step 4: Test on a Device <a class="header-anchor" href="#step-4-test-on-a-device" aria-label="Permalink to &quot;Step 4: Test on a Device&quot;">​</a></h3><ol><li><p><strong>Trigger Sync</strong>: On the test device:</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">gpupdate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">force</span></span></code></pre></div><p>Or: Intune Portal → Devices → [Device] → Sync</p></li><li><p><strong>Check Registry</strong>:</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Get-ItemProperty</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Path </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;HKCU:\\Software\\Policies\\FaserF\\SwitchCraft&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ErrorAction SilentlyContinue</span></span></code></pre></div></li><li><p><strong>Check Event Logs</strong>:</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Get-WinEvent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LogName </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Microsoft-Windows-User Device Registration/Admin&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MaxEvents </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Where-Object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.LevelDisplayName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-eq</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Error&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    Format-List</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> TimeCreated</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Message</span></span></code></pre></div></li></ol><h2 id="complete-example-configuration" tabindex="-1">Complete Example Configuration <a class="header-anchor" href="#complete-example-configuration" aria-label="Permalink to &quot;Complete Example Configuration&quot;">​</a></h2><p>Here is a complete, correct configuration for all failed policies:</p><h3 id="_1-signscripts-enf" tabindex="-1">1. SignScripts_Enf <a class="header-anchor" href="#_1-signscripts-enf" aria-label="Permalink to &quot;1. SignScripts_Enf&quot;">​</a></h3><ul><li><strong>OMA-URI</strong>: <code>./User/Vendor/MSFT/Policy/Config/SwitchCraft~Policy~FaserF~SwitchCraft~SwitchCraft~Enforced~Security_Enf/SignScripts_Enf</code></li><li><strong>Data Type</strong>: <code>String</code></li><li><strong>Value</strong>: <code>&lt;enabled/&gt;</code></li></ul><h3 id="_2-updatechannel-enf" tabindex="-1">2. UpdateChannel_Enf <a class="header-anchor" href="#_2-updatechannel-enf" aria-label="Permalink to &quot;2. UpdateChannel_Enf&quot;">​</a></h3><ul><li><strong>OMA-URI</strong>: <code>./User/Vendor/MSFT/Policy/Config/SwitchCraft~Policy~FaserF~SwitchCraft~SwitchCraft~Enforced~Updates_Enf/UpdateChannel_Enf</code></li><li><strong>Data Type</strong>: <code>String</code></li><li><strong>Value</strong>: <code>&lt;enabled/&gt;&lt;data id=&quot;UpdateChannelDropdown&quot; value=&quot;stable&quot;/&gt;</code></li></ul><h3 id="_3-enablewinget-enf" tabindex="-1">3. EnableWinget_Enf <a class="header-anchor" href="#_3-enablewinget-enf" aria-label="Permalink to &quot;3. EnableWinget_Enf&quot;">​</a></h3><ul><li><strong>OMA-URI</strong>: <code>./User/Vendor/MSFT/Policy/Config/SwitchCraft~Policy~FaserF~SwitchCraft~SwitchCraft~Enforced~General_Enf/EnableWinget_Enf</code></li><li><strong>Data Type</strong>: <code>String</code></li><li><strong>Value</strong>: <code>&lt;enabled/&gt;</code></li></ul><h3 id="_4-aiprovider-enf" tabindex="-1">4. AIProvider_Enf <a class="header-anchor" href="#_4-aiprovider-enf" aria-label="Permalink to &quot;4. AIProvider_Enf&quot;">​</a></h3><ul><li><strong>OMA-URI</strong>: <code>./User/Vendor/MSFT/Policy/Config/SwitchCraft~Policy~FaserF~SwitchCraft~SwitchCraft~Enforced~AI_Enf/AIProvider_Enf</code></li><li><strong>Data Type</strong>: <code>String</code></li><li><strong>Value</strong>: <code>&lt;enabled/&gt;&lt;data id=&quot;AIProviderDropdown&quot; value=&quot;local&quot;/&gt;</code></li></ul><h3 id="_5-graphtenantid-enf" tabindex="-1">5. GraphTenantId_Enf <a class="header-anchor" href="#_5-graphtenantid-enf" aria-label="Permalink to &quot;5. GraphTenantId_Enf&quot;">​</a></h3><ul><li><strong>OMA-URI</strong>: <code>./User/Vendor/MSFT/Policy/Config/SwitchCraft~Policy~FaserF~SwitchCraft~SwitchCraft~Enforced~Intune_Enf/GraphTenantId_Enf</code></li><li><strong>Data Type</strong>: <code>String</code></li><li><strong>Value</strong>: <code>&lt;enabled/&gt;&lt;data id=&quot;GraphTenantIdBox&quot; value=&quot;YOUR-TENANT-ID&quot;/&gt;</code></li></ul><h3 id="_6-companyname-enf" tabindex="-1">6. CompanyName_Enf <a class="header-anchor" href="#_6-companyname-enf" aria-label="Permalink to &quot;6. CompanyName_Enf&quot;">​</a></h3><ul><li><strong>OMA-URI</strong>: <code>./User/Vendor/MSFT/Policy/Config/SwitchCraft~Policy~FaserF~SwitchCraft~SwitchCraft~Enforced~General_Enf/CompanyName_Enf</code></li><li><strong>Data Type</strong>: <code>String</code></li><li><strong>Value</strong>: <code>&lt;enabled/&gt;&lt;data id=&quot;CompanyNameBox&quot; value=&quot;Your Company Name&quot;/&gt;</code></li></ul><h3 id="_7-graphclientid-enf" tabindex="-1">7. GraphClientId_Enf <a class="header-anchor" href="#_7-graphclientid-enf" aria-label="Permalink to &quot;7. GraphClientId_Enf&quot;">​</a></h3><ul><li><strong>OMA-URI</strong>: <code>./User/Vendor/MSFT/Policy/Config/SwitchCraft~Policy~FaserF~SwitchCraft~SwitchCraft~Enforced~Intune_Enf/GraphClientId_Enf</code></li><li><strong>Data Type</strong>: <code>String</code></li><li><strong>Value</strong>: <code>&lt;enabled/&gt;&lt;data id=&quot;GraphClientIdBox&quot; value=&quot;YOUR-CLIENT-ID&quot;/&gt;</code></li></ul><h3 id="_8-intunetestgroups-enf" tabindex="-1">8. IntuneTestGroups_Enf <a class="header-anchor" href="#_8-intunetestgroups-enf" aria-label="Permalink to &quot;8. IntuneTestGroups_Enf&quot;">​</a></h3><ul><li><strong>OMA-URI</strong>: <code>./User/Vendor/MSFT/Policy/Config/SwitchCraft~Policy~FaserF~SwitchCraft~SwitchCraft~Enforced~Intune_Enf/IntuneTestGroups_Enf</code></li><li><strong>Data Type</strong>: <code>String</code></li><li><strong>Value</strong>: <code>&lt;enabled/&gt;&lt;data id=&quot;IntuneTestGroupsBox&quot; value=&quot;GroupID1,GroupID2&quot;/&gt;</code></li></ul><h3 id="_9-graphclientsecret-enf" tabindex="-1">9. GraphClientSecret_Enf <a class="header-anchor" href="#_9-graphclientsecret-enf" aria-label="Permalink to &quot;9. GraphClientSecret_Enf&quot;">​</a></h3><ul><li><strong>OMA-URI</strong>: <code>./User/Vendor/MSFT/Policy/Config/SwitchCraft~Policy~FaserF~SwitchCraft~SwitchCraft~Enforced~Intune_Enf/GraphClientSecret_Enf</code></li><li><strong>Data Type</strong>: <code>String</code></li><li><strong>Value</strong>: <code>&lt;enabled/&gt;&lt;data id=&quot;GraphClientSecretBox&quot; value=&quot;YOUR-CLIENT-SECRET&quot;/&gt;</code></li></ul><h2 id="checklist-before-recreating" tabindex="-1">Checklist Before Recreating <a class="header-anchor" href="#checklist-before-recreating" aria-label="Permalink to &quot;Checklist Before Recreating&quot;">​</a></h2><p>Before recreating a policy, check:</p><ul><li>[ ] ADMX installation shows &quot;Succeeded&quot; ✅</li><li>[ ] Data Type is <strong>&quot;String&quot;</strong> (not &quot;Integer&quot; or &quot;Boolean&quot;)</li><li>[ ] OMA-URI path matches documentation <strong>exactly</strong> (including tildes)</li><li>[ ] XML format is correct (<code>&lt;enabled/&gt;</code> or <code>&lt;enabled/&gt;&lt;data id=&quot;...&quot; value=&quot;...&quot;/&gt;</code>)</li><li>[ ] Element ID matches ADMX file exactly (e.g., <code>GraphTenantIdBox</code>, not <code>GraphTenantId</code>)</li><li>[ ] No typos in Value (e.g., in UUIDs or secrets)</li></ul><h2 id="if-nothing-helps" tabindex="-1">If Nothing Helps <a class="header-anchor" href="#if-nothing-helps" aria-label="Permalink to &quot;If Nothing Helps&quot;">​</a></h2><ol><li><strong>Delete ALL failed policies</strong> completely</li><li><strong>Wait 5-10 minutes</strong> (Intune needs time to synchronize)</li><li><strong>Recreate the policies</strong> - one by one, starting with a simple one (e.g., <code>EnableWinget_Enf</code>)</li><li><strong>Test each policy individually</strong> before creating the next one</li><li>If errors persist: <strong>Delete and recreate the ADMX installation</strong></li></ol><h2 id="additional-resources" tabindex="-1">Additional Resources <a class="header-anchor" href="#additional-resources" aria-label="Permalink to &quot;Additional Resources&quot;">​</a></h2><ul><li><a href="./GPO_TROUBLESHOOTING">GPO Troubleshooting Guide</a></li><li><a href="./Intune_Configuration_Guide">Intune Configuration Guide</a></li><li><a href="./PolicyDefinitions/README">Policy Definitions README</a></li></ul>`,95)])])}const g=t(n,[["render",l]]);export{k as __pageData,g as default};
