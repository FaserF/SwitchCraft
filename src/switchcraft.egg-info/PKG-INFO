Metadata-Version: 2.4
Name: switchcraft
Version: 2025.12.3
Summary: A universal silent switch finder and installer analyzer.
Author: FaserF
License: MIT License

        Copyright (c) 2025 FaserF

        Permission is hereby granted, free of charge, to any person obtaining a copy
        of this software and associated documentation files (the "Software"), to deal
        in the Software without restriction, including without limitation the rights
        to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
        copies of the Software, and to permit persons to whom the Software is
        furnished to do so, subject to the following conditions:

        The above copyright notice and this permission notice shall be included in all
        copies or substantial portions of the Software.

        THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
        IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
        FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
        AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
        LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
        OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
        SOFTWARE.

Project-URL: Homepage, https://github.com/FaserF/SwitchCraft
Keywords: installer,silent-install,automation,winget,msi,exe
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python
Classifier: Programming Language :: Python :: 3
Requires-Python: >=3.9
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: pefile
Requires-Dist: olefile
Requires-Dist: requests
Requires-Dist: click
Requires-Dist: rich
Requires-Dist: py7zr
Requires-Dist: customtkinter
Requires-Dist: tkinterdnd2
Requires-Dist: pillow
Requires-Dist: PyYAML
Dynamic: license-file

# SwitchCraft ğŸ§™â€â™‚ï¸

<img src="switchcraft_logo.png" width="200" alt="SwitchCraft Logo">

**SwitchCraft** is your ultimate cross-platform utility for identifying silent installation parameters for EXE and MSI packages. Designed for IT Admins, Packagers, and Developers.

## âœ¨ Features

- **ğŸ” Universal Analysis**:
  - **MSI**: Extracts `ProductCode`, `UpgradeCode`, manufacturer, version, and standard `/qn` switches
  - **EXE**: Auto-detects installer framework and suggests appropriate silent switches
  - **Metadata**: Parses PE version info for product name, version, and company
- **ğŸ“¦ Winget Integration**: Automatically checks if the package exists in the **Windows Package Manager** (winget) repository
- **ğŸ–¥ï¸ GUI & Drag'n'Drop**: Modern, dark-mode friendly desktop interface
- **âš”ï¸ Automatic Brute Force**: Runs 15+ help argument variations to discover switches
- **ğŸ”§ Cross-Platform**: Built with Python, running on Windows, Linux, and macOS
- **ğŸŒ Multi-Language**: English and German interface

## ğŸ¯ Supported Installer Types

| Installer Type | Detection Confidence | Silent Install Switch |
|---------------|---------------------|----------------------|
| **MSI Database** | 100% | `/qn /norestart` |
| **NSIS** | 90% | `/S` |
| **Inno Setup** | 90% | `/VERYSILENT /SUPPRESSMSGBOXES /NORESTART` |
| **InstallShield** | 80% | `/s /v"/qn"` |
| **7-Zip SFX** | 90% | `/S` |
| **WiX Burn Bundle** | 85% | `/quiet /norestart` |
| **Advanced Installer** | 80% | `/exenoui /qn` |
| **Wise Installer** | 80% | `/S` |
| **Setup Factory** | 75% | `/S` |
| **Squirrel (Electron)** | 80% | `--silent` |
| **PyInstaller App** | 85% | N/A (not an installer) |
| **cx_Freeze App** | 80% | N/A (not an installer) |

## ğŸš€ Installation

### Pre-built Binaries
Download the latest standalone executable from the [Releases](https://github.com/FaserF/SwitchCraft/releases) page:
- **Windows**: `SwitchCraft-windows.exe`
- **Linux**: `SwitchCraft-linux`
- **macOS**: `SwitchCraft-macos`

No Python installation required!

### From Source
```bash
git clone https://github.com/FaserF/SwitchCraft.git
cd SwitchCraft
pip install .
```

## ğŸ’» Usage

### GUI Mode
Simply run the application without arguments:
```bash
switchcraft
# or
python -m switchcraft.gui.app
```
Then **Drag & Drop** your installer into the window or click to browse.

### CLI Mode
```bash
# Basic analysis
switchcraft analyze setup.exe

# JSON output for scripting
switchcraft analyze setup.exe --json

# Check version
switchcraft --version
```

## ğŸ”§ Supported File Types

| Extension | Description |
|-----------|-------------|
| `.exe` | Windows Executable (installer or packaged app) |
| `.msi` | Windows Installer Database |

## âš”ï¸ Brute Force Parameter Discovery

When no installer type is detected, SwitchCraft automatically tries these help arguments:

```
/?  --help  -h  /help  /h  -?  --info  -help  --usage  -V  --version  /info  -i  --silent  /silent
```

The output is analyzed for common patterns and displayed in the GUI.

## ğŸ› ï¸ Development

### Prerequisites
- Python 3.9+
- Install dependencies: `pip install -e .[dev]`

### Running Tests
```bash
python -m unittest discover tests
```

### Building Executables Manually

#### Using PyInstaller (Recommended)
```bash
# Install PyInstaller and dependencies
pip install pyinstaller customtkinter tkinterdnd2 pillow

# Build using the spec file
pyinstaller switchcraft.spec

# The executable will be in dist/SwitchCraft.exe (Windows) or dist/SwitchCraft (Linux/Mac)
```

#### Using cx_Freeze (Alternative)
```bash
pip install cx_Freeze
python setup_freeze.py build
```

### Project Structure
```
SwitchCraft/
â”œâ”€â”€ src/switchcraft/
â”‚   â”œâ”€â”€ analyzers/        # Installer detection logic
â”‚   â”‚   â”œâ”€â”€ base.py       # Abstract base analyzer
â”‚   â”‚   â”œâ”€â”€ exe.py        # EXE analyzer (11+ installer types)
â”‚   â”‚   â”œâ”€â”€ msi.py        # MSI database analyzer
â”‚   â”‚   â””â”€â”€ universal.py  # Brute force & wrapper detection
â”‚   â”œâ”€â”€ gui/              # CustomTkinter GUI
â”‚   â”‚   â””â”€â”€ app.py        # Main application window
â”‚   â”œâ”€â”€ utils/            # Helper utilities
â”‚   â”‚   â”œâ”€â”€ i18n.py       # Internationalization
â”‚   â”‚   â”œâ”€â”€ updater.py    # Auto-update checker
â”‚   â”‚   â””â”€â”€ winget.py     # Winget repository lookup
â”‚   â””â”€â”€ main.py           # CLI entry point
â”œâ”€â”€ tests/                # Unit tests
â””â”€â”€ switchcraft.spec      # PyInstaller build specification
```

## ğŸ“‹ Release Types

SwitchCraft uses CalVer versioning: `YEAR.MONTH.PATCH[-suffix]`

| Release Type | Version Format | Example | Description |
|-------------|---------------|---------|-------------|
| **Stable** | `YYYY.MM.X` | `2025.12.3` | Production-ready release |
| **Pre-release (Beta)** | `YYYY.MM.X-beta` | `2025.12.4-beta` | Feature-complete but testing |
| **Development** | `YYYY.MM.X-dev` | `2025.12.5-dev` | Experimental builds |

> **Note**: Beta and development versions display a warning banner in the GUI.

## ğŸ¤ Contributing
Open Source under the **MIT License**. PRs are welcome!

1. Fork the repository
2. Create your feature branch: `git checkout -b feature/amazing-feature`
3. Commit your changes: `git commit -m 'Add amazing feature'`
4. Push to the branch: `git push origin feature/amazing-feature`
5. Open a Pull Request

## ğŸ“œ License
MIT Â© 2025 FaserF

## ğŸ”— Links
- [GitHub Repository](https://github.com/FaserF/SwitchCraft)
- [Release Downloads](https://github.com/FaserF/SwitchCraft/releases)
- [Silent Install Database](https://silent.ls/)
